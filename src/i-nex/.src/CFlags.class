' Gambas class file

Public BUFFER As String
Public DATAT As Collection
Public Sub Form_Open()
  Dim z As Integer
  Me.Center
  Me.X = Settings["Window/X", Me.X]
  Me.Y = Settings["Window/Y", Me.Y]
  Exec ["/home/michal/Baazar/git-i-nex/inex-cpuid"] Wait To BUFFER
  DATAT = JSON.Decode(BUFFER)
  ListView1.Add(0, DATAT["VENDOR_STR"])
  ListView1.Add(1, DATAT["CPU_CODENAME"])
  ListView1.Add(2, DATAT["BRAND_STR"])
  ListView1.Add(3, DATAT["NUM_CORES"])
  ListView1.Add(4, DATAT["NUM_LOGICAL_CPUS"])
  ListView1.Add(5, DATAT["TOTAL_LOGICAL_CPUS"])
  ListView1.Add(6, DATAT["FAMILY"])
  ListView1.Add(7, DATAT["MODEL"])
  ListView1.Add(8, DATAT["STEPPING"])
  ListView1.Add(9, DATAT["EXT_FAMILY"])
  ListView1.Add(10, DATAT["EXT_MODEL"])
  ListView1.Add(11, DATAT["CPU_CLOCK"])
  ListView1.Add(12, DATAT["CPU_CLOCK_BY_OS"])
  ListView1.Add(13, DATAT["CPU_CLOCK_BY_IC"])
  ListView1.Add(14, DATAT["CPU_CLOCK_MEASURE"])
  ListView1.Add(15, DATAT["MARK_TSC"])
  ListView1.Add(16, DATAT["MARK_SYS_CLOCK"])
  For z = 0 To 93
   If DATAT["Flags"][z]["VALUE"] = 1 Then
    ListView1.Add(z + 17, DATAT["Flags"][z]["NAME"] & " " & DATAT["Flags"][z]["VALUE"] & " " & DATAT["Flags"][z]["DESC"])
   Endif
  Next
End

Public Sub Button1_Click()

 Me.Close

End
