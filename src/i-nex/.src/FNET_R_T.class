' Gambas class file

Public Sub net_()
Dim total_interfaces As String
 Dim Face, Face2 As String
 Dim Maximum, i, ty, i2, ty2 As Integer
 Shell "ls /sys/class/net | tr ' ' '\n' | wc -l" To total_interfaces
 GridView1.Columns.Count = 9
 GridView1.Rows.Count = CFloat(Val(total_interfaces)) + 1
 GridView2.Columns.Count = 9
 GridView2.Rows.Count = CFloat(Val(total_interfaces)) + 1
 Maximum = CInteger(Val(total_interfaces)) + 2
 For i = 3 To Maximum
  Shell "awk {'print $1'} /proc/net/dev | sed -n '" & i & "p'" To Face
  GridView1[i - 2, 0].Text = Replace(Face, "\n", "")
  For ty = 1 To 9
   Shell "awk {'print $" & ty & "'} /proc/net/dev | sed -n '" & i & "p'" To Face
   GridView1[i - 2, ty - 1].Text = Replace(Face, "\n", "")
  Next
 Next
 For i2 = 3 To Maximum
  Shell "cat /proc/net/dev | awk {'print $1'} | sed -n '" & i2 & "p'" Wait To Face2
  GridView2[i2 - 2, 0].Text = Replace(Face2, "\n", "")
  For ty2 = 10 To 17
   Shell "cat /proc/net/dev | awk {'print $" & ty2 & "'} | sed -n '" & i2 & "p'" Wait To Face2
   GridView2[i2 - 2, ty2 - 9].Text = Replace(Face2, "\n", "")
  Next
 Next
 GridView1.Columns[1].Width = 75
 GridView1.Columns[2].Width = 75
 GridView1.Columns[8].Width = 75
 GridView1[0, 0].Text = "Face"
 GridView1[0, 1].Text = "Bytes"
 GridView1[0, 2].Text = "Packets"
 GridView1[0, 3].Text = "Errs"
 GridView1[0, 4].Text = "Drop"
 GridView1[0, 5].Text = "Fifo"
 GridView1[0, 6].Text = "Frame"
 GridView1[0, 7].Text = "Comp"
 GridView1[0, 8].Text = "Multicast"
 GridView2.Columns[1].Width = 75
 GridView1.Columns[2].Width = 75
 GridView2[0, 0].Text = "Face"
 GridView2[0, 1].Text = "Bytes"
 GridView2[0, 2].Text = "Packets"
 GridView2[0, 3].Text = "Errs"
 GridView2[0, 4].Text = "Drop"
 GridView2[0, 5].Text = "Fifo"
 GridView2[0, 6].Text = "Colls"
 GridView2[0, 7].Text = "Carrier"
 GridView2[0, 8].Text = "Comp"
End

Public Sub Timer1_Timer()

 net_()

End

Public Sub Form_Open()
 Me.Center
 Timer1.Start
 net_()
End
