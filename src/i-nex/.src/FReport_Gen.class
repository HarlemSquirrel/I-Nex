' Gambas class file

Public Sub Form_Open()
  Dim unity_support_test As Boolean = Exist("/usr/lib/nux/unity_support_test")
  ButtonBox1.Text = Desktop.Path & "/report.txt"
  If unity_support_test = True Then
  CheckBox10.Visible = True
  Endif
  ComboBox1.Add("cxg.de")
  ComboBox1.Add("fpaste.org")
  ComboBox1.Add("paste2.org")
  ComboBox1.Add("pastebin.com")
  ComboBox1.Add("paste.debian.net")
  ComboBox1.Add("paste.debian.net")
  ComboBox1.Add("paste.drizzle.org")
  ComboBox1.Add("paste.kde.org")
  ComboBox1.Add("paste.openstack.org")
  ComboBox1.Add("susepaste.org")
  ComboBox1.Add("paste.pocoo.org")
  ComboBox1.Add("paste.pound-python.org")
  ComboBox1.Add("paste.ubuntu.com")
  ComboBox1.Add("paste.ubuntu.org.cn")
  ComboBox1.Add("pastie.org")
  ComboBox1.Add("pb.daviey.com")
  ComboBox1.Add("p.defau.lt")
  ComboBox1.Add("slexy.org")
  ComboBox1.Add("sprunge.us")
  ComboBox1.Add("yourpaste.net")
  ComboBox1.Add("paste.opensuse.org")
  
Me.Center

End

Public Sub Button1_Click()
Shell "rm " & ButtonBox1.Text & "" Wait
If CheckBox1.Value = True Then
 Object.Call(MCPU_REPORT, "_inits")
Endif
If CheckBox3.Value = True Then
 Object.Call(MGPU_REPORT, "_inits")
Endif
If CheckBox2.Value = True Then
 Object.Call(MMOBO_REPORT, "_inits")
Endif
If CheckBox4.Value = True Then
 Object.Call(MSOUND_REPORT, "_inits")
Endif
If CheckBox5.Value = True Then
 Object.Call(MSYSTEM_REPORT, "_inits")
Endif
If CheckBox12.Value = True Then
 Object.Call(MKERNEL_REPORT, "_inits")
Endif
If CheckBox11.Value = True Then
 TextBox1.Text = MPastebinit.pastebin(True, ButtonBox1.Text, ComboBox1.Text)
Endif
End

Public Sub ButtonBox1_Click()
 Dialog.Title = "Choose a file"
 Dialog.Filter = ["*.txt", "Text files"]
 Dialog.SaveFile
 ButtonBox1.Text = Dialog.Path
 If Exist(ButtonBox1.Text, True) Then
 Shell "rm " & Dialog.Path & "" Wait
 Endif
End

Public Sub Button3_Click()
 If TextBox1.Text Like "*http*" Then
  Desktop.Open(TextBox1.Text)
 Else 
  Debug "Pastebin link not detect"
  Message.Warning("Please select the Send to pastebin and then click on the  generate button.\nThis will take you to pastebin site. ")
 Endif
End
