' Gambas class file

Public Sub Form_Open()
  If Exist("~/.i-nex/lastsave") Then
   ButtonBox1.Text = File.Load("" & User.Home & "/.i-nex/lastsave")
  Else
   ButtonBox1.Text = Desktop.Path & "/report.txt"
  Endif

  ComboBox1.Add("pastebin.com")
  ComboBox1.Add("cxg.de")
  ComboBox1.Add("slexy.org")
  ComboBox1.Add("fpaste.org")
  ComboBox1.Add("paste2.org")
  ComboBox1.Add("pastie.org")
  ComboBox1.Add("p.defau.lt")
  ComboBox1.Add("sprunge.us")
  ComboBox1.Add("pb.daviey.com")
  ComboBox1.Add("paste.kde.org")
  ComboBox1.Add("susepaste.org")
  ComboBox1.Add("paste.pocoo.org")
  ComboBox1.Add("paste.ubuntu.com")
  ComboBox1.Add("paste.debian.net")
  ComboBox1.Add("paste.drizzle.org")
  ComboBox1.Add("paste.opensuse.org")
  ComboBox1.Add("paste.openstack.org")
  ComboBox1.Add("paste.ubuntu.org.cn")
  ComboBox1.Add("paste.pound-python.org")
  'ComboBox1.Add("yourpaste.net")
  'ComboBox1.Add("dpaste.com")
  'ComboBox1.Add("hpaste.org")
  
Me.Center

End

Public Sub Button1_Click()
'Before generate report. Old report must be removed
Shell "rm " & ButtonBox1.Text & "" Wait
'Check Value, select report to be generated.
If CheckBox1.Value = True Then
 Object.Call(MCPU_REPORT, "_inits")
Endif

If CheckBox3.Value = True Then
 Object.Call(MGPU_REPORT, "_inits")
Endif

If CheckBox2.Value = True Then
 Object.Call(MMOBO_REPORT, "_inits")
Endif

If CheckBox4.Value = True Then
 Object.Call(MSOUND_REPORT, "_inits")
Endif

If CheckBox5.Value = True Then
 Object.Call(MSYSTEM_REPORT, "_inits")
Endif

If CheckBox12.Value = True Then
 Object.Call(MKERNEL_REPORT, "_inits")
Endif

If CheckBox14.value = True Then
 Object.Call(MDRIVES_REPORT, "_inits")
Endif

If CheckBox6.Value = True Then
 Object.Call(MInclude, "_lspci")
Endif

If CheckBox7.Value = True Then
 Object.Call(MInclude, "_lsusb")
Endif

If CheckBox8.Value = True Then
 Object.Call(MInclude, "_scsi")
Endif

If CheckBox15.Value = True Then
 Object.Call(MInclude, "_mtrr")
Endif

If CheckBox16.Value = True Then
 Object.Call(MInclude, "_devices")
Endif

If CheckBox17.Value = True Then
 Object.Call(MInclude, "_diskstats")
Endif

If CheckBox18.Value = True Then
 Object.Call(MInclude, "_dma")
Endif

If CheckBox10.Value = True Then
 Object.Call(MInclude, "_partitions")
Endif

If CheckBox19.Value = True Then
 Object.Call(MInclude, "_modules")
Endif

If CheckBox20.Value = True Then
 Object.Call(MInclude, "_cmdline")
Endif

If CheckBox21.Value = True Then
 Object.Call(MInclude, "_grub")
Endif

If CheckBox9.Value = True Then
 Object.Call(MInclude, "_dmesg")
Endif

If CheckBox11.Value = True Then
 TextBox1.Text = MPastebinit.pastebin(True, ButtonBox1.Text, ComboBox1.Text)
Endif

If CheckBox13.value = True And CheckBox11.Value = False Then
 Form_Close()
Endif
End

Public Sub ButtonBox1_Click()
  Dim savefile As String
 
  If ChkPrm.ChkExec("kdialog") = True Then
     Exec ["kdialog", "--getsaveurl", "~/", ".txt"] Wait To savefile
     ButtonBox1.Text = Replace(savefile, "file://", "")
  Else If ChkPrm.ChkExec("yad") = True Then
     Exec ["yad", "--width=600", "--height=500", "--align=center", "--file-selection", "--filename=report.txt", "--file-filter=*.txt"] Wait To savefile
     ButtonBox1.Text = Replace(savefile, "file://", "")
  Else If ChkPrm.ChkExec("zenity") = True Then
     Exec ["zenity", "--file-selection", "--confirm-overwrite", "--filename=report.txt", "--file-filter=*.txt"] Wait To savefile
     ButtonBox1.Text = Replace(savefile, "file://", "")
  Else
     Dialog.Title = "Choose a file"
     Dialog.Filter = ["*.txt", "Text files"]
     Dialog.SaveFile
     ButtonBox1.Text = Dialog.Path
  Endif
 
  If Exist(ButtonBox1.Text, True) Then
  Try Kill ButtonBox1.Text
  Endif
  
End

Public Sub Button2_Click()
 
 Form_Close()
 
End


Public Sub Button3_Click()
 If TextBox1.Text Like "*http*" Then
  Desktop.Open(TextBox1.Text)
 Else 
  Debug "Pastebin link not detect"
  Message.Warning("Please select the Send to pastebin and then click on the  generate button.\nThis will take you to pastebin site. ")
 Endif
End

Public Sub Button4_Click()
 If TextBox1.Text = Null Then
  Message.Error("Nothing to copy, \nplease first generate report and select: \nSend to nopaste service", "OK")
 Else
  Clipboard.Copy(TextBox1.Text)
 Endif

End

Public Sub Form_Close()
  File.Save("" & User.Home & "/.i-nex/lastsave", ButtonBox1.Text)
  Me.Close
  Finfosys.Show
 
End
