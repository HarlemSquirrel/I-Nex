' Gambas class file


Public Sub Form_Open()
 Dim unity_support_test As Boolean = Exist("/usr/lib/nux/unity_support_test")
 ButtonBox1.Text = Desktop.Path & "/report.txt"
 If unity_support_test = True Then
  CheckBox10.Visible = True
 Endif
 If ChkPrm.ChkExec("curl") = False Then
  CheckBox11.Visible = False
  TextBox1.Visible = False
  Button3.Visible = False
 Endif
 Me.Center

End

Public Sub Button1_Click()
 Dim URL As String
 If ButtonBox1.Text = Null Then
  Message.Warning("Please select directory to save the report about your hardware")
 Else
 Shell "rm " & ButtonBox1.Text & ""
 Reportm._generate(CheckBox1.Value, CheckBox2.Value, CheckBox3.Value, CheckBox4.Value, ButtonBox1.Text)
 Reportm.desktop_support(CheckBox10.Value, ButtonBox1.Text)
 Reportm.include(CheckBox6.Value, CheckBox7.Value, CheckBox8.Value, CheckBox9.Value, ButtonBox1.Text)
 TextBox1.Text = Reportm.pastebin(CheckBox11.Value, ButtonBox1.Text)
 Endif
 If (Application.Args[1] = "--gen_report") Then
  Finfosys.Close
 Endif
 If CheckBox11.Value = False Then
 Try Me.Close
 Endif
End

Public Sub ButtonBox1_Click()
 Dialog.Title = "Choose a file"
 Dialog.Filter = ["*.txt", "Text files"]
 Dialog.SaveFile
 ButtonBox1.Text = Dialog.Path
 If Exist(ButtonBox1.Text, True) Then
 Shell "rm " & Dialog.Path & "" Wait
 Endif
End

Public Sub Button2_Click()
 If (Application.Args[1] = "--gen_report") Then
  Finfosys.Close
 Endif
 Me.Close

End

Public Sub Button3_Click()
 If TextBox1.Text Like "*http*" Then
  Desktop.Open(TextBox1.Text)
 Else 
  Debug "Pastebin link not detect"
  Message.Warning("Please select the Send to pastebin and then click on the  generate button.\nThis will take you to pastebin site. ")
 Endif
 

End
